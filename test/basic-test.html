<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

    <script src="../node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script>
    <script src="../node_modules/@polymer/test-fixture/test-fixture.js"></script>
    <script src="../node_modules/mocha/mocha.js"></script>
    <script src="../node_modules/chai/chai.js"></script>
    <script src="../node_modules/wct-mocha/wct-mocha.js"></script>

    <script type="module" src="../uuid-generator.js"></script>
  </head>
  <body>

    <test-fixture id="Basic">
      <template>
        <uuid-generator></uuid-generator>
      </template>
    </test-fixture>

    <test-fixture id="Auto">
      <template>
        <uuid-generator auto></uuid-generator>
      </template>
    </test-fixture>

    <script type="module">
    suite('Basic', () => {
      test('Generates valid UUID', () => {
        const element = fixture('Basic');
        const uuid = element.generate();
        assert.isString(uuid, 'UUID is a string');
        assert.lengthOf(uuid, 36, 'uuid has length of 36');
        const parts = uuid.split('-');
        assert.equal(parts.length, 5, 'uuid has 5 parts');
        assert.equal(parts[0].length, 8, 'part 1 has 8 characters');
        assert.equal(parts[1].length, 4, 'part 2 has 4 characters');
        assert.equal(parts[2].length, 4, 'part 3 has 4 characters');
        assert.equal(parts[3].length, 4, 'part 4 has 4 characters');
        assert.equal(parts[4].length, 12, 'part 5 has 12 characters');
      });

      test('Sets lastUuid', () => {
        const element = fixture('Basic');
        const uuid = element.generate();
        assert.typeOf(element.lastUuid, 'string');
        assert.equal(element.lastUuid, uuid);
      });
    });

    suite('Auto', () => {
      test('Generates UUID automatically', () => {
        const element = fixture('Auto');
        assert.typeOf(element.lastUuid, 'string');
      });

      test('Regenrates uuid when auto status changes', () => {
        const element = fixture('Auto');
        const first = element.lastUuid;
        element.auto = false;
        element.auto = true;
        const last = element.lastUuid;
        assert.typeOf(last, 'string');
        assert.notEqual(last, first);
      });
    });
    </script>
  </body>
</html>
